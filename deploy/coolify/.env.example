# OpenDS Coolify Deployment Configuration
# Copy this file to .env and update values

# ============================================
# REQUIRED: Security Configuration
# ============================================

# Generate a strong random 32-character secret for JWT tokens
# Command: openssl rand -hex 32
JWT_SECRET=change-me-to-a-strong-random-secret

# Generate a strong random 32-character encryption key for token encryption
# Command: openssl rand -hex 32
TOKEN_ENC_KEY=change-me-to-a-strong-random-encryption-key

# ============================================
# REQUIRED: Database Configuration
# ============================================

# PostgreSQL credentials (auto-configured in Coolify)
POSTGRES_USER=postgres
POSTGRES_PASSWORD=change-me-to-a-secure-password
POSTGRES_DB=opends

# ============================================
# REQUIRED: Application Configuration
# ============================================

# CORS origin - set to your domain (with https://)
# Example: https://opends.yourdomain.com
CORS_ORIGIN=http://localhost:3000

# Public base URL for the backend API
# Example: https://api.opends.yourdomain.com
PUBLIC_BASE_URL=http://localhost:3001

# ============================================
# OPTIONAL: Figma Integration
# ============================================

# Get these from Figma Developer Portal: https://www.figma.com/developers
FIGMA_CLIENT_ID=
FIGMA_CLIENT_SECRET=
# Callback URL must match exactly what's registered in Figma
FIGMA_REDIRECT_URI=${PUBLIC_BASE_URL}/api/auth/figma/callback

# ============================================
# OPTIONAL: Penpot Integration
# ============================================

# Get these from your Penpot instance admin panel
PENPOT_CLIENT_ID=
PENPOT_CLIENT_SECRET=
# Penpot OIDC issuer (default: Penpot Cloud)
PENPOT_OIDC_ISSUER=https://design.penpot.app/auth
# Callback URL must match exactly what's registered in Penpot
PENPOT_REDIRECT_URI=${PUBLIC_BASE_URL}/api/auth/penpot/callback
# Penpot API URL (default: Penpot Cloud)
PENPOT_API_URL=https://design.penpot.app/api

# ============================================
# OPTIONAL: Storage Configuration
# ============================================

# S3-compatible storage for design assets
# Leave empty to use local filesystem storage
S3_REGION=us-east-1
S3_ENDPOINT=
S3_ACCESS_KEY_ID=
S3_SECRET_ACCESS_KEY=
S3_BUCKET=opends-assets
S3_FORCE_PATH_STYLE=false

# ============================================
# OPTIONAL: Advanced Configuration
# ============================================

# Application version (used in Docker image tags)
OPENDS_VERSION=latest

# Log level: fatal, error, warn, info, debug, trace
LOG_LEVEL=info

# Redis URL (auto-configured in Coolify)
REDIS_URL=redis://redis:6379

# Database URL (auto-configured from PostgreSQL vars above)
DATABASE_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@postgres:5432/${POSTGRES_DB}

# ============================================
# GENERATION COMMANDS
# ============================================

# To generate secure secrets:
# JWT_SECRET:    openssl rand -hex 32
# TOKEN_ENC_KEY: openssl rand -hex 32
# POSTGRES_PASSWORD: openssl rand -hex 16

# After updating, restart services:
# docker-compose -f stack.yml down
# docker-compose -f stack.yml up -d